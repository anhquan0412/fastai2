---

title: Data Callbacks

keywords: fastai
sidebar: home_sidebar

summary: "Callbacks which work with a learner's data"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/14a_callback.data.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">nbdev.showdoc</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">fastai2.test_utils</span> <span class="k">import</span> <span class="o">*</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="CollectDataCallback" class="doc_header"><code>class</code> <code>CollectDataCallback</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/callback/data.py#L9" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>CollectDataCallback</code>() :: <a href="/learner#Callback"><code>Callback</code></a></p>
</blockquote>
<p>Collect all batches, along with <code>pred</code> and <code>loss</code>, into <code>self.data</code>. Mainly for testing</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="WeightedDL" class="doc_header"><code>class</code> <code>WeightedDL</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/callback/data.py#L16" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>WeightedDL</code>(<strong><code>dataset</code></strong>=<em><code>None</code></em>, <strong><code>bs</code></strong>=<em><code>None</code></em>, <strong><code>wgts</code></strong>=<em><code>None</code></em>, <strong><code>shuffle</code></strong>=<em><code>False</code></em>, <strong><code>num_workers</code></strong>=<em><code>None</code></em>, <strong><code>pin_memory</code></strong>=<em><code>False</code></em>, <strong><code>timeout</code></strong>=<em><code>0</code></em>, <strong><code>batch_size</code></strong>=<em><code>None</code></em>, <strong><code>drop_last</code></strong>=<em><code>False</code></em>, <strong><code>indexed</code></strong>=<em><code>None</code></em>, <strong><code>n</code></strong>=<em><code>None</code></em>, <strong><code>device</code></strong>=<em><code>None</code></em>, <strong><code>wif</code></strong>=<em><code>None</code></em>, <strong><code>before_iter</code></strong>=<em><code>None</code></em>, <strong><code>after_item</code></strong>=<em><code>None</code></em>, <strong><code>before_batch</code></strong>=<em><code>None</code></em>, <strong><code>after_batch</code></strong>=<em><code>None</code></em>, <strong><code>after_iter</code></strong>=<em><code>None</code></em>, <strong><code>create_batches</code></strong>=<em><code>None</code></em>, <strong><code>create_item</code></strong>=<em><code>None</code></em>, <strong><code>create_batch</code></strong>=<em><code>None</code></em>, <strong><code>retain</code></strong>=<em><code>None</code></em>, <strong><code>get_idxs</code></strong>=<em><code>None</code></em>, <strong><code>sample</code></strong>=<em><code>None</code></em>, <strong><code>shuffle_fn</code></strong>=<em><code>None</code></em>, <strong><code>do_batch</code></strong>=<em><code>None</code></em>) :: <a href="/data.core#TfmdDL"><code>TfmdDL</code></a></p>
</blockquote>
<p>Transformed <a href="/data.load#DataLoader"><code>DataLoader</code></a></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="weighted_databunch" class="doc_header"><code>weighted_databunch</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/callback/data.py#L28" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>weighted_databunch</code>(<strong><code>wgts</code></strong>, <strong><code>bs</code></strong>=<em><code>64</code></em>, <strong><code>val_bs</code></strong>=<em><code>None</code></em>, <strong><code>shuffle_train</code></strong>=<em><code>True</code></em>, <strong><code>n</code></strong>=<em><code>None</code></em>, <strong><code>path</code></strong>=<em><code>'.'</code></em>, <strong><code>dl_type</code></strong>=<em><code>None</code></em>, <strong><code>dl_kwargs</code></strong>=<em><code>None</code></em>, <strong><code>device</code></strong>=<em><code>None</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">160</span>
<span class="n">dsrc</span> <span class="o">=</span> <span class="n">Datasets</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">())</span>
<span class="n">dbch</span> <span class="o">=</span> <span class="n">dsrc</span><span class="o">.</span><span class="n">weighted_databunch</span><span class="p">(</span><span class="n">wgts</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="n">bs</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">learn</span> <span class="o">=</span> <span class="n">synth_learner</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dbch</span><span class="p">,</span> <span class="n">cb_funcs</span><span class="o">=</span><span class="n">CollectDataCallback</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">concat</span><span class="p">(</span><span class="o">*</span><span class="n">learn</span><span class="o">.</span><span class="n">collect_data</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">itemgot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">t</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(#4) [0,nan,None,00:00]
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
</div>
 

